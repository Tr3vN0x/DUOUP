<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr3vMedia Neon Swipe Interface</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* --- NEON LED THEME STYLES --- */
        :root {
            --bg-dark: #0F1117;          /* Deep Black/Navy */
            --neon-green: #00FF66;       /* Bright Neon Accent */
            --neon-glow: 0 0 8px var(--neon-green), 0 0 15px var(--neon-green); /* The Glow Effect */
            --card-bg: #1B1E28;          /* Slightly lighter dark background for cards */
            --text-light: #E0E0E0;
        }

        body {
            font-family: 'Share Tech Mono', monospace, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: var(--bg-dark);
            color: var(--neon-green);
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-shadow: var(--neon-glow);
            margin-bottom: 30px;
            font-size: 2em;
        }

        /* --- CARD & SWIPE STYLES --- */
        .swipe-container {
            position: relative;
            width: 320px;
            height: 400px;
            margin-bottom: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: var(--card-bg);
            border-radius: 12px;
            /* Neon Border and Glow */
            border: 2px solid var(--neon-green);
            box-shadow: 0 0 10px rgba(0, 255, 102, 0.5); 
            overflow: hidden;
            cursor: grab;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            will-change: transform, opacity;
            display: flex;
            flex-direction: column;
            text-align: center;
        }

        .card:active {
            cursor: grabbing;
        }

        .card-image {
            width: 100%;
            height: 70%;
            object-fit: cover;
            /* Subtle separation line */
            border-bottom: 1px solid var(--neon-green);
        }

        .card-info {
            padding: 15px;
            height: 30%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .card-info h3 {
            margin: 0 0 5px 0;
            font-size: 1.2em;
            color: var(--neon-green);
            text-shadow: 0 0 5px rgba(0, 255, 102, 0.7);
        }

        .card-info p {
            margin: 0;
            font-size: 0.9em;
            color: var(--text-light);
        }

        /* Classes added by JavaScript for final swipe animation */
        .swipe-right {
            transform: translateX(500px) rotate(20deg) !important;
            opacity: 0;
        }

        .swipe-left {
            transform: translateX(-500px) rotate(-20deg) !important;
            opacity: 0;
        }

        /* --- CONTROLS & UI STYLES --- */

        .controls {
            display: flex;
            gap: 20px;
        }

        .controls button, .ui-button {
            padding: 15px 25px;
            font-size: 1.1em;
            border: 2px solid var(--neon-green);
            border-radius: 50px;
            cursor: pointer;
            background-color: var(--card-bg);
            color: var(--neon-green);
            box-shadow: var(--neon-glow);
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .controls button:hover, .ui-button:hover {
            background-color: var(--neon-green);
            color: var(--bg-dark);
            transform: translateY(-2px);
            box-shadow: none; /* Turn off glow on hover for a 'pressed' look */
        }

        #noMoreCards {
            position: absolute;
            font-size: 1.2em;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            color: var(--neon-green);
            border: 2px solid var(--neon-green);
            box-shadow: var(--neon-glow);
            display: none;
        }

        /* --- MODAL/FORM STYLES --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            border: 2px solid var(--neon-green);
            box-shadow: var(--neon-glow);
            width: 90%;
            max-width: 400px;
            color: var(--text-light);
        }
        
        .modal-content h2 {
            color: var(--neon-green);
            text-shadow: var(--neon-glow);
            margin-top: 0;
            border-bottom: 1px dashed var(--neon-green);
            padding-bottom: 10px;
        }

        .modal-content label {
            display: block;
            margin-top: 15px;
            color: var(--neon-green);
        }

        .modal-content input[type="text"], .modal-content textarea {
            width: calc(100% - 22px);
            padding: 10px;
            margin-top: 5px;
            background: var(--bg-dark);
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            border-radius: 4px;
            box-shadow: 0 0 5px rgba(0, 255, 102, 0.3);
        }

        .modal-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
    </style>
</head>
<body>

    <header>
        <h1>TR3VMEDIA // ENGAGE</h1>
        <button id="customizeBtn" class="ui-button">‚öôÔ∏è Customize Card</button>
        <button id="loginBtn" class="ui-button">üîì Login/Logout</button>
    </header>

    <div class="swipe-container">
        <div id="noMoreCards">
            NO MORE MEDIA. REBOOTING SEQUENCE...
        </div>
        </div>

    <div class="controls">
        <button id="dislikeBtn">‚ùå SKIP</button>
        <button id="likeBtn">‚ù§Ô∏è ENGAGE</button>
    </div>

    <div id="loginModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2 id="loginTitle">System Login</h2>
            <form id="loginForm">
                <label for="username">User Handle:</label>
                <input type="text" id="username" value="tr3vmedia" required>
                <label for="password">Password (Mock):</label>
                <input type="text" id="password" value="pass123" required>
                <div class="modal-actions">
                    <button type="submit" class="ui-button">Access System</button>
                    <button type="button" class="ui-button" onclick="closeLoginModal()">Abort</button>
                </div>
            </form>
            <div id="logoutSection" style="display: none;">
                <p>Logged in as: <strong id="loggedInUser"></strong></p>
                <div class="modal-actions">
                    <button type="button" class="ui-button" onclick="logout()">Terminate Session</button>
                </div>
            </div>
        </div>
    </div>

    <div id="customizeModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Customize Your Card</h2>
            <p style="color: red;">* Requires mock login to save changes.</p>
            <form id="cardCustomizationForm">
                <label for="cardTitle">Project Title:</label>
                <input type="text" id="cardTitle" maxlength="30" required>

                <label for="cardDesc">Description (Max 50 chars):</label>
                <textarea id="cardDesc" maxlength="50" required></textarea>

                <label for="cardMedia">Media URL (Placeholder):</label>
                <input type="text" id="cardMedia" placeholder="https://picsum.photos/320/280?user=..." required> 
                
                <div class="modal-actions">
                    <button type="submit" class="ui-button">üíæ SAVE CARD</button>
                    <button type="button" class="ui-button" onclick="closeCustomizeModal()">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // --- JAVASCRIPT LOGIC ---

        // Mock Database of Cards (This is what a server would send)
        let CARD_DATA = [
            { id: 1, title: "City Sunset Time-lapse", user: "@trev_photo", description: "A beautiful 4K time-lapse project.", imageUrl: "https://picsum.photos/320/280?random=1" },
            { id: 2, title: "Street Interview Series", user: "@urban_media", description: "Asking strangers about their biggest dreams.", imageUrl: "https://picsum.photos/320/280?random=2" },
            { id: 3, title: "Experimental Film Trailer", user: "@arthouse_vid", description: "A sneak peek at my new short film.", imageUrl: "https://picsum.photos/320/280?random=3" },
            { id: 4, title: "Nature Photography Gallery", user: "@wildlens", description: "Capturing the beauty of the PNW forests.", imageUrl: "https://picsum.photos/320/280?random=4" },
        ];
        
        // --- UI ELEMENTS ---
        const swipeContainer = document.querySelector('.swipe-container');
        const dislikeBtn = document.getElementById('dislikeBtn');
        const likeBtn = document.getElementById('likeBtn');
        const noMoreCards = document.getElementById('noMoreCards');
        const customizeBtn = document.getElementById('customizeBtn');
        const loginBtn = document.getElementById('loginBtn');
        
        let currentCardIndex = 0;
        let isUserLoggedIn = false;
        let userCardData = JSON.parse(localStorage.getItem('userCard')) || {
            id: 'user_custom',
            title: "My Custom Media Card",
            user: localStorage.getItem('userHandle') || "@Guest",
            description: "Customize this description in the modal!",
            imageUrl: "https://picsum.photos/320/280?user=tr3vmedia"
        };


        // --- 1. CARD RENDERING ---

        function createCard(data) {
            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.id = data.id;

            card.innerHTML = `
                <img class="card-image" src="${data.imageUrl}" alt="${data.title}">
                <div class="card-info">
                    <h3>${data.title.toUpperCase()}</h3>
                    <p>By ${data.user} | ${data.description}</p>
                </div>
            `;
            return card;
        }

        function loadNextCard() {
            // Check if user's own card should be inserted
            if (currentCardIndex === 0 && isUserLoggedIn) {
                const userCard = createCard(userCardData);
                swipeContainer.appendChild(userCard);
                addSwipeListeners(userCard);
            }
            
            // Load from the mock database
            if (currentCardIndex < CARD_DATA.length) {
                const cardData = CARD_DATA[currentCardIndex];
                const newCard = createCard(cardData);
                swipeContainer.appendChild(newCard);
                currentCardIndex++;
                addSwipeListeners(newCard);
                noMoreCards.style.display = 'none';
            } else if (swipeContainer.children.length === 0 || (swipeContainer.children.length === 1 && swipeContainer.children[0].id === 'noMoreCards')) {
                // All cards processed and cleared
                noMoreCards.style.display = 'block';
                // Reset index to allow looping/reloading for demo purposes
                currentCardIndex = 0; 
                // A real app would stop or refresh here
            }
        }

        // --- 2. SWIPE AND DRAG LOGIC (From previous response) ---

        function swipeCard(card, direction) {
            card.classList.add(`swipe-${direction}`);

            // Mock API call to record interaction
            console.log(`[API Mock] Card ID ${card.dataset.id} swiped ${direction}.`);

            setTimeout(() => {
                card.remove();
                loadNextCard();
            }, 300);
        }
        
        function addSwipeListeners(card) {
            let startX, startY;
            let isDragging = false;
            
            function handleStart(e) {
                e.preventDefault();
                isDragging = true;
                startX = e.clientX || e.touches[0].clientX;
                startY = e.clientY || e.touches[0].clientY;
                card.style.transition = 'none';
            }

            function handleMove(e) {
                if (!isDragging) return;

                const currentX = e.clientX || e.touches[0].clientX;
                const deltaX = currentX - startX;
                const rotate = deltaX / 20;

                card.style.transform = `translateX(${deltaX}px) rotate(${rotate}deg)`;
            }

            function handleEnd(e) {
                if (!isDragging) return;
                isDragging = false;
                
                card.style.transition = 'transform 0.3s ease-out, opacity 0.3s ease-out';

                const finalX = e.clientX || e.changedTouches[0].clientX;
                const deltaX = finalX - startX;
                const threshold = 100;

                if (deltaX > threshold) {
                    swipeCard(card, 'right');
                } else if (deltaX < -threshold) {
                    swipeCard(card, 'left');
                } else {
                    card.style.transform = 'translate(0) rotate(0)';
                }
            }

            card.addEventListener('mousedown', handleStart);
            card.addEventListener('touchstart', handleStart);

            document.addEventListener('mousemove', handleMove);
            document.addEventListener('touchmove', handleMove);

            document.addEventListener('mouseup', handleEnd);
            document.addEventListener('touchend', handleEnd);
            
            card.addEventListener('remove', () => {
                document.removeEventListener('mousemove', handleMove);
                document.removeEventListener('touchmove', handleMove);
                document.removeEventListener('mouseup', handleEnd);
                document.removeEventListener('touchend', handleEnd);
            });
        }

        // --- 3. LOGIN / AUTHENTICATION MOCK ---
        
        function updateLoginState(handle, isLoggedIn) {
            isUserLoggedIn = isLoggedIn;
            localStorage.setItem('isLoggedIn', isLoggedIn);
            localStorage.setItem('userHandle', handle);
            
            loginBtn.textContent = isLoggedIn ? `üîí LOGOUT (${handle})` : 'üîì LOGIN/LOGOUT';
            document.getElementById('loggedInUser').textContent = handle;
            document.getElementById('logoutSection').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('loginForm').style.display = isLoggedIn ? 'none' : 'block';
            document.getElementById('loginTitle').textContent = isLoggedIn ? 'System Status' : 'System Login';
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            // In a real app, this would send credentials to a server
            
            if (username) {
                updateLoginState(username, true);
                closeLoginModal();
                alert(`[API Mock] Token received. Welcome, ${username}!`);
                loadNextCard(); // Reload the cards to show user's own card
            } else {
                alert('Please enter a username.');
            }
        });
        
        function logout() {
            // In a real app, this would destroy the JWT
            updateLoginState('@Guest', false);
            localStorage.removeItem('userToken');
            closeLoginModal();
            alert('[API Mock] Session Terminated.');
            window.location.reload(); // Simple way to reset demo state
        }
        
        loginBtn.addEventListener('click', () => {
            const modal = document.getElementById('loginModal');
            modal.style.display = 'flex';
        });

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }


        // --- 4. CUSTOMIZATION MOCK ---

        customizeBtn.addEventListener('click', () => {
            if (!isUserLoggedIn) {
                alert('ACCESS DENIED. Please log in to customize your card.');
                return;
            }
            
            // Populate form with current user card data
            document.getElementById('cardTitle').value = userCardData.title;
            document.getElementById('cardDesc').value = userCardData.description;
            document.getElementById('cardMedia').value = userCardData.imageUrl;
            
            document.getElementById('customizeModal').style.display = 'flex';
        });

        function closeCustomizeModal() {
            document.getElementById('customizeModal').style.display = 'none';
        }

        document.getElementById('cardCustomizationForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // 1. Update the local userCardData object
            userCardData.title = document.getElementById('cardTitle').value;
            userCardData.description = document.getElementById('cardDesc').value;
            userCardData.imageUrl = document.getElementById('cardMedia').value;
            userCardData.user = localStorage.getItem('userHandle');

            // 2. Mock persistence (Save to browser storage)
            localStorage.setItem('userCard', JSON.stringify(userCardData));

            // 3. Mock API Call
            console.log(`[API Mock] User Card Saved to Server:`, userCardData);
            
            alert('Card data successfully saved and updated!');
            closeCustomizeModal();
            window.location.reload(); // Simple way to ensure the new card is at the top
        });


        // --- INITIALIZATION ---
        function init() {
            // Check for previous login state
            const handle = localStorage.getItem('userHandle') || '@Guest';
            const loggedIn = localStorage.getItem('isLoggedIn') === 'true';
            updateLoginState(handle, loggedIn);

            // Start the card loading sequence
            loadNextCard();
        }

        // --- BUTTON CONTROLS (Swipe without dragging) ---

        dislikeBtn.addEventListener('click', () => {
            const topCard = swipeContainer.querySelector('.card:last-child');
            if (topCard) swipeCard(topCard, 'left');
        });

        likeBtn.addEventListener('click', () => {
            const topCard = swipeContainer.querySelector('.card:last-child');
            if (topCard) swipeCard(topCard, 'right');
        });
        
        init();

    </script>
</body>
</html>
