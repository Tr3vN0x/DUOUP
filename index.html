<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Ink - Single Owner Hub</title>
    <style>
        /* --- GLOBAL STYLES (Neon Theme) --- */
        :root {
            --color-bg: #1a1a1a;
            --color-text: #e0e0e0;
            --color-neon: #00ffcc; 
            --color-accent: #ff0077; 
            --color-border: #333;
            --font-display: 'Segoe UI', Arial, sans-serif;
            --font-mono: 'Consolas', monospace;
        }

        body { 
            font-family: var(--font-display); 
            margin: 0; 
            background-color: var(--color-bg); 
            color: var(--color-text); 
            line-height: 1.6;
        }
        
        h1, h2, h3 { color: var(--color-neon); text-shadow: 0 0 5px var(--color-neon); }
        h1 { font-family: var(--font-mono); }
        
        .hidden { display: none !important; }

        /* --- HEADER & NAVIGATION --- */
        header { 
            background-color: #000000; 
            padding: 15px 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 2px solid var(--color-neon);
            box-shadow: 0 0 10px var(--color-neon);
        }
        header h1 { 
            margin: 0; 
            cursor: pointer; 
            font-size: 1.8em;
            letter-spacing: 2px;
        }
        
        .nav-btn { 
            background-color: var(--color-bg); 
            color: var(--color-neon); 
            padding: 8px 15px; 
            text-decoration: none; 
            border: 1px solid var(--color-neon); 
            border-radius: 5px; 
            cursor: pointer; 
            font-weight: bold; 
            margin-left: 10px;
            box-shadow: 0 0 5px var(--color-neon);
            transition: all 0.3s;
        }
        .nav-btn:hover { 
            background-color: var(--color-neon); 
            color: var(--color-bg); 
            box-shadow: 0 0 10px var(--color-neon), 0 0 20px var(--color-neon);
        }

        /* User Info in Header */
        #userInfo { font-size: 0.9em; margin-right: 15px; color: var(--color-text); }
        #userInfo strong { color: var(--color-accent); }

        /* --- CONTAINER AND LAYOUT --- */
        .main-layout { 
            display: flex; 
            max-width: 1200px; 
            margin: 20px auto; 
            padding: 0 20px;
        }
        .sidebar { 
            width: 200px; 
            margin-right: 20px; 
            padding: 15px; 
            background-color: #222; 
            border-radius: 8px;
            border: 1px solid var(--color-border);
            align-self: flex-start;
        }
        .content { 
            flex-grow: 1; 
            padding: 15px; 
            background-color: #222; 
            border-radius: 8px;
            border: 1px solid var(--color-border);
        }

        /* --- FORM STYLES (Create View) --- */
        #createView input[type="text"], #createView textarea, #createView select {
            width: 100%; 
            padding: 10px; 
            background-color: #444; 
            color: var(--color-text);
            border: 1px solid var(--color-neon); 
            border-radius: 5px; 
            box-sizing: border-box; 
            margin-bottom: 15px;
        }
        #createView label { color: var(--color-neon); }
        #createView textarea { height: 300px; }


        /* --- STORY LIST VIEW STYLES --- */
        #storyList { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); 
            gap: 20px; 
            margin-top: 20px; 
        }
        .story-card { 
            display: flex; 
            background-color: #333; 
            border: 1px solid #444; 
            padding: 15px; 
            border-radius: 8px; 
            transition: all 0.3s;
        }
        .story-card:hover { 
            border-color: var(--color-neon); 
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.5); 
            transform: translateY(-2px);
        }
        .card-thumbnail { 
            width: 80px; 
            height: 120px; 
            object-fit: cover; 
            border-radius: 4px; 
            margin-right: 15px;
            border: 2px solid var(--color-accent);
        }
        .card-details h3 { font-size: 1.3em; margin-top: 0; margin-bottom: 5px; }
        .card-details p { margin: 0 0 3px 0; font-size: 0.9em; color: #aaa; }
        .read-link { 
            color: var(--color-accent); 
            text-decoration: none; 
            font-weight: bold; 
            cursor: pointer; 
            display: block; 
            margin-top: 10px;
        }

        /* --- PROFILE VIEW --- */
        #profileView { text-align: center; }
        #profilePicture { 
            width: 150px; 
            height: 150px; 
            border-radius: 50%; 
            object-fit: cover; 
            border: 4px solid var(--color-accent); 
            margin-bottom: 15px;
        }
        #profileView h2 { font-size: 2em; margin-bottom: 5px; }
        #profileBio { font-style: italic; color: #aaa; max-width: 600px; margin: 0 auto 20px; }
        #userStoriesList { margin-top: 30px; border-top: 1px solid #444; padding-top: 20px; }
        .story-card-profile {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #333;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 3px solid var(--color-neon);
        }
        .story-card-profile h4 { margin: 0; color: var(--color-text); }
        .story-card-profile a { color: var(--color-accent); text-decoration: none; }

        /* --- READ VIEW STYLES --- */
        #readView { font-family: var(--font-display); padding: 20px; }
        #readView .story-title { font-size: 2.8em; color: var(--color-neon); }
        #readView .story-author { color: var(--color-accent); font-style: italic; margin-bottom: 20px; }
        #readView .chapter-text { font-size: 1.1em; line-height: 1.7; margin-top: 20px; }
        #readView hr { margin: 30px 0; border: 0; border-top: 1px solid var(--color-border); }
    </style>
</head>
<body>

    <header>
        <h1 onclick="showView('listView')">
            <span style="color: var(--color-accent);">N</span>eon <span style="color: var(--color-accent);">I</span>nk üí°
        </h1>
        <nav>
            <div id="userInfo"></div>
            <button class="nav-btn" onclick="showView('profileView')">üë§ My Stories</button>
            <button class="nav-btn" onclick="showView('createView')">‚úçÔ∏è Write</button>
            <button class="nav-btn" onclick="showView('listView')">üìñ Read</button>
        </nav>
    </header>

    <div class="main-layout">
        
        <aside class="sidebar" id="sidebar">
            <h2>Categories</h2>
            <ul class="category-list" id="categoryList">
                <li><a class="category-item active" onclick="filterStories('All')">All Stories</a></li>
                <li><a class="category-item" onclick="filterStories('Fantasy')">Fantasy</a></li>
                <li><a class="category-item" onclick="filterStories('Sci-Fi')">Sci-Fi</a></li>
                <li><a class="category-item" onclick="filterStories('Romance')">Romance</a></li>
                <li><a class="category-item" onclick="filterStories('Thriller')">Thriller</a></li>
            </ul>
        </aside>

        <div class="content">
            
            <section id="listView">
                <h2>Explore New Worlds</h2>
                <div id="storyList">
                    <p>Loading stories...</p>
                </div>
            </section>

            <section id="createView" class="hidden">
                <h2>‚úçÔ∏è Create Your Masterpiece</h2>
                <p style="color: var(--color-accent);">Posting as: <strong>Neon Admin</strong></p>
                <div class="form-group">
                    <label for="storyTitle">Story Title</label>
                    <input type="text" id="storyTitle" required>
                </div>
                <div class="form-group">
                    <label for="storyCategory">Category</label>
                    <select id="storyCategory">
                        <option value="General">General</option>
                        <option value="Fantasy">Fantasy</option>
                        <option value="Sci-Fi">Sci-Fi</option>
                        <option value="Romance">Romance</option>
                        <option value="Thriller">Thriller</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="storyThumbnailUrl">Thumbnail Image URL (Optional)</label>
                    <input type="text" id="storyThumbnailUrl" placeholder="Paste an image URL here">
                </div>
                <div class="form-group">
                    <label for="storyContent">Chapter 1 Content</label>
                    <textarea id="storyContent" required></textarea>
                </div>
                <button id="publishButton" class="nav-btn" style="background-color: var(--color-accent); color: var(--color-bg); border-color: var(--color-accent);">Publish Story</button>
            </section>
            
            <section id="readView" class="hidden">
                <button class="nav-btn" onclick="showView('listView')">‚Üê Back to Stories</button>
                <div id="storyContentContainer"></div>
            </section>

            <section id="profileView" class="hidden">
                <img id="profilePicture" src="https://via.placeholder.com/150/1a1a1a/00ffcc?text=A" alt="Profile Picture">
                <h2 id="profileUsername"></h2>
                <p id="profileBio"></p>
                
                <div id="userStoriesList">
                    <h3>My Published Stories</h3>
                    </div>
                
            </section>

        </div>
    </div> <script>
        // --- FIXED OWNER/ADMIN USER ---
        const OWNER_USERNAME = "Neon Admin";
        const OWNER_PROFILE = {
            username: OWNER_USERNAME,
            bio: "The sole creator and curator of all content on Neon Ink.",
            profilePic: "https://via.placeholder.com/150/ff0077/1a1a1a?text=ADMIN" // Custom admin image placeholder
        };

        // --- DATA KEYS ---
        const STORIES_KEY = 'stories';
        const OWNER_DATA_KEY = 'owner_profile'; // Use a dedicated key for the single owner's bio/pic
        let currentFilter = 'All';

        // --- DATA RETRIEVAL/STORAGE UTILITIES ---
        function getStories() {
            const storiesJSON = localStorage.getItem(STORIES_KEY);
            return storiesJSON ? JSON.parse(storiesJSON) : [];
        }
        function saveStories(storiesArray) {
            localStorage.setItem(STORIES_KEY, JSON.stringify(storiesArray));
        }

        // We use a simplified function to get the current user (always the owner)
        function getLoggedInUser() {
            return OWNER_USERNAME;
        }
        
        // Function to ensure the OWNER_PROFILE is correctly stored/used
        function getOwnerProfile() {
            const profileJSON = localStorage.getItem(OWNER_DATA_KEY);
            if (profileJSON) {
                return JSON.parse(profileJSON);
            }
            // Initialize owner profile if it doesn't exist
            localStorage.setItem(OWNER_DATA_KEY, JSON.stringify(OWNER_PROFILE));
            return OWNER_PROFILE;
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substring(2);
        }

        // --- NAVIGATION & VIEW MANAGEMENT ---
        function showView(viewId) {
            // Hide all views
            document.getElementById('listView').classList.add('hidden');
            document.getElementById('createView').classList.add('hidden');
            document.getElementById('readView').classList.add('hidden');
            document.getElementById('profileView').classList.add('hidden');
            document.getElementById('sidebar').classList.remove('hidden');

            // Show the requested view
            document.getElementById(viewId).classList.remove('hidden');

            if (viewId === 'listView') {
                renderStoryList();
            } else if (viewId === 'profileView') {
                renderProfileView(OWNER_USERNAME);
            } else if (viewId === 'readView') {
                document.getElementById('sidebar').classList.add('hidden');
            }
        }


        // --- 1. LIST VIEW & CATEGORY FILTERING LOGIC ---
        function filterStories(category) {
            currentFilter = category;
            
            document.querySelectorAll('.category-item').forEach(el => el.classList.remove('active'));
            document.querySelector(`.category-item[onclick*="'${category}'"]`).classList.add('active');
            
            renderStoryList(); 
        }

        function renderStoryList(filterByUsername = null) {
            const allStories = getStories();
            const listContainer = document.getElementById('storyList');
            listContainer.innerHTML = ''; 

            let filteredStories = allStories;

            // Filter logic is now simple: either filter by category or by the owner's name
            if (currentFilter !== 'All' && !filterByUsername) {
                filteredStories = allStories.filter(s => s.category === currentFilter);
            }
            if (filterByUsername) {
                filteredStories = allStories.filter(s => s.author === filterByUsername);
            }

            if (filteredStories.length === 0) {
                listContainer.innerHTML = `<p style="color: var(--color-accent);">
                    No stories found in the '${currentFilter}' category yet.
                </p>`;
                return;
            }

            filteredStories.forEach(story => {
                const storyCard = document.createElement('div');
                storyCard.className = 'story-card';
                
                const thumbnailUrl = story.thumbnailUrl.trim() || 'https://via.placeholder.com/80x120/1a1a1a/00ffcc?text=NEON+INK';

                storyCard.innerHTML = `
                    <img src="${thumbnailUrl}" class="card-thumbnail" alt="Story Thumbnail">
                    <div class="card-details">
                        <h3>${story.title}</h3>
                        <p><strong>Category:</strong> ${story.category}</p>
                        <p><strong>By:</strong> ${story.author}</p>
                        <a class="read-link" onclick="renderStory('${story.id}')">Start Reading &rarr;</a>
                    </div>
                `;
                listContainer.appendChild(storyCard);
            });
        }

        // --- 2. CREATE VIEW LOGIC ---
        document.getElementById('publishButton').addEventListener('click', () => {
            // No sign-in check needed, owner is always active

            const titleInput = document.getElementById('storyTitle');
            const categorySelect = document.getElementById('storyCategory');
            const thumbnailInput = document.getElementById('storyThumbnailUrl');
            const contentInput = document.getElementById('storyContent');

            const title = titleInput.value.trim();
            const category = categorySelect.value;
            const thumbnailUrl = thumbnailInput.value.trim();
            const content = contentInput.value.trim();

            if (!title || !content) {
                alert('Title and content are required.');
                return;
            }

            const newStory = {
                id: generateId(),
                title: title,
                author: OWNER_USERNAME, // Always post as the owner
                category: category,
                thumbnailUrl: thumbnailUrl,
                chapters: [{
                    title: 'Chapter 1',
                    content: content,
                    datePublished: new Date().toLocaleDateString()
                }],
                dateCreated: new Date().toLocaleDateString()
            };

            const stories = getStories();
            stories.push(newStory);
            saveStories(stories);

            // Clear form
            titleInput.value = '';
            thumbnailInput.value = '';
            contentInput.value = '';
            categorySelect.value = 'General';
            alert('Story published successfully!');
            
            filterStories('All'); 
            showView('listView');
        });

        // --- 3. READ VIEW LOGIC ---
        function renderStory(storyId) {
            const stories = getStories();
            const story = stories.find(s => s.id === storyId);
            const container = document.getElementById('storyContentContainer');
            
            if (!story) {
                container.innerHTML = '<h1 style="color: var(--color-accent);">Story Not Found</h1>';
                showView('readView');
                return;
            }

            const chapter = story.chapters[0]; 

            container.innerHTML = `
                <h1 class="story-title">${story.title}</h1>
                <p class="story-author">By: ${story.author} | Category: ${story.category}</p>
                <hr>
                <div class="chapter-text">${chapter.content.replace(/\n/g, '<br>')}</div>
                <p class="publish-date" style="color:#777; font-size: 0.9em;">Published on: ${chapter.datePublished}</p>
            `;

            showView('readView');
        }

        // --- 4. PROFILE VIEW LOGIC ---
        function renderProfileView(targetUsername) {
            // In single-owner mode, we always display the owner's profile
            const user = getOwnerProfile();
            
            document.getElementById('profileUsername').textContent = user.username;
            document.getElementById('profileBio').textContent = user.bio;
            document.getElementById('profilePicture').src = user.profilePic;

            // Display user's stories
            const userStoriesContainer = document.getElementById('userStoriesList');
            userStoriesContainer.innerHTML = '<h3>My Published Stories</h3>';
            
            const userStories = getStories().filter(s => s.author === user.username);

            if (userStories.length === 0) {
                 userStoriesContainer.innerHTML += `<p style="color: var(--color-accent);">
                    You have not published any stories yet.
                </p>`;
            } else {
                userStories.forEach(story => {
                    const storyDiv = document.createElement('div');
                    storyDiv.className = 'story-card-profile';
                    storyDiv.innerHTML = `
                        <h4>${story.title}</h4>
                        <a onclick="renderStory('${story.id}')">Read &rarr;</a>
                    `;
                    userStoriesContainer.appendChild(storyDiv);
                });
            }

            showView('profileView');
        }


        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            // Display who you are posting as in the header
            document.getElementById('userInfo').innerHTML = `Posting as: <strong>${OWNER_USERNAME}</strong>`;
            
            filterStories('All'); 
            showView('listView');
            
            // Ensure the owner profile is initialized in Local Storage
            getOwnerProfile(); 
        });
    </script>
</body>
</html>
